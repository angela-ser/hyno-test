/** 
 * Dont't edit or remove this plugin
 * ---------------------------------
 * 
 * Special thanks to adiwajshing/Baileys for Baileys (library)
 *
 * GITHUB ðŸ˜º
 * 
 * 
 * HyNOBOT: https://github.com/hyno-ir/hyno-md
 * Creator: https://github.com/hyno-ir
 * Baileys: https://github.com/adiwajshing/Baileys
 * -----------------------------------------------
 * 
 * HyNO is the first and best Iranian WhatsApp bot
 * Don't forget to give a star on our github page for this reposity
 * ---------------------------------------------------------------
 * 
 * Creator WaLink: https://wa.me/989389383634
 * -------------------------------------------------
 * 
 * Â© HyNOBOT (GNU General Public License v3.0)
 *
 *â•”â•—â”€â•”â•—â”€â”€â”€â•”â•â•—â”€â•”â•¦â•â•â•â•—
 *â•‘â•‘â”€â•‘â•‘â”€â”€â”€â•‘â•‘â•šâ•—â•‘â•‘â•”â•â•—â•‘
 *â•‘â•šâ•â•â• â•—â”€â•”â•£â•”â•—â•šâ•â•‘â•‘â”€â•‘â•‘
 *â•‘â•”â•â•—â•‘â•‘â”€â•‘â•‘â•‘â•šâ•—â•‘â•‘â•‘â”€â•‘â•‘
 *â•‘â•‘â”€â•‘â•‘â•šâ•â•â•‘â•‘â”€â•‘â•‘â•‘â•šâ•â•â•‘
 *â•šâ•â”€â•šâ•©â•â•—â•”â•©â•â”€â•šâ•â•©â•â•â•â•
 *â”€â”€â”€â”€â•”â•â•â•‘
 *â”€â”€â”€â”€â•šâ•â•â•
 **/


const fs = require('fs')
const {writeFile} = require('fs/promises')
const PastebinAPI = require("pastebin-js"),
  pastebin = new PastebinAPI("h4cO2gJEMwmgmBoteYufW6_weLvBYCqT");
module.exports = {
  /**
   * Write Session To file
   * @param {string} session_id The Unique Id That you got
   * @param {string} authFile  The Session File name
   * Default Session name is "authfile"
   *
   * Make sure to Define global.authfile Before function
   *
   * Initialize at the top Body
   *
   * Make Sure To Give  a timeout of minimum 3 seconds for the Waconnection Function
   *
   *
   **/
  async MakeSession(session_id, authFile) {
    return new Promise((resolve, reject) => {
        code = session_id.replace(/_H_y_N_O_/g, "");
        code = Buffer.from(code, "base64").toString("utf-8");
          pastebin
            .getPaste(code)
            .then(async function (data) {
              if (!fs.existsSync(authFile)) {
               await writeFile(authFile, data);
               resolve(true)
              }
            })
            .fail(function (err) {
                reject(err)
              console.log(err);
            });  
    })
    

  },
};
